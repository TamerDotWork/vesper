
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CSV File Upload and Preview</title>
    <link rel="stylesheet" href="static/css/style.css">
 
 
    <link rel="icon" href="static/favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1"></script>

</head>
<body>

    <div class="container">
        <header>
            <div class="row">
                <div class="col-md-2">
                    <div class="logo"><a href="./"><img src="static/logo.svg" alt=""></a></div>
                </div>
                <div class="col-md-2">
                    <nav class="center-head">
                      
                        <ul>
                            <li><a href="./">Home</a></li>
                            <li><a href="./pricing">Pricing</a></li>
                            <li><a href="./support">Support</a></li>
                            <li><a href="./about">About</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="col-md-8">
                    <nav class="right-head">
                        <ul>
                
                            <li><a href="./profile">
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12.12 13.53C12.1 13.53 12.07 13.53 12.05 13.53C12.02 13.53 11.98 13.53 11.95 13.53C9.67998 13.46 7.97998 11.69 7.97998 9.51001C7.97998 7.29001 9.78998 5.48001 12.01 5.48001C14.23 5.48001 16.04 7.29001 16.04 9.51001C16.03 11.7 14.32 13.46 12.15 13.53C12.13 13.53 12.13 13.53 12.12 13.53ZM12 6.97001C10.6 6.97001 9.46998 8.11001 9.46998 9.50001C9.46998 10.87 10.54 11.98 11.9 12.03C11.93 12.02 12.03 12.02 12.13 12.03C13.47 11.96 14.52 10.86 14.53 9.50001C14.53 8.11001 13.4 6.97001 12 6.97001Z" fill="#3A3A3A"/>
<path d="M12 22.75C9.30996 22.75 6.73996 21.75 4.74996 19.93C4.56996 19.77 4.48996 19.53 4.50996 19.3C4.63996 18.11 5.37996 17 6.60996 16.18C9.58996 14.2 14.42 14.2 17.39 16.18C18.62 17.01 19.36 18.11 19.49 19.3C19.52 19.54 19.43 19.77 19.25 19.93C17.26 21.75 14.69 22.75 12 22.75ZM6.07996 19.1C7.73996 20.49 9.82996 21.25 12 21.25C14.17 21.25 16.26 20.49 17.92 19.1C17.74 18.49 17.26 17.9 16.55 17.42C14.09 15.78 9.91996 15.78 7.43996 17.42C6.72996 17.9 6.25996 18.49 6.07996 19.1Z" fill="#3A3A3A"/>
<path d="M12 22.75C6.07 22.75 1.25 17.93 1.25 12C1.25 6.07 6.07 1.25 12 1.25C17.93 1.25 22.75 6.07 22.75 12C22.75 17.93 17.93 22.75 12 22.75ZM12 2.75C6.9 2.75 2.75 6.9 2.75 12C2.75 17.1 6.9 21.25 12 21.25C17.1 21.25 21.25 17.1 21.25 12C21.25 6.9 17.1 2.75 12 2.75Z" fill="#3A3A3A"/>
</svg>
</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </header>
        
        <main>

            <div class="row">
                
                <div class="col-md-2 sidebar">
                    <strong>Quick Actions</strong>
                    <ul>
                        <li><a href="./">

<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M9 17V11L7 13" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M9 11L11 13" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M22 10V15C22 20 20 22 15 22H9C4 22 2 20 2 15V9C2 4 4 2 9 2H14" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M22 10H18C15 10 14 9 14 6V2L22 10Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

Upload</a></li>
                        <li><a href="./explore">

<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10 17.5H14" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2 17.5V7.5C2 3.5 3 2.5 7 2.5" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M22 17.5V7.5C22 3.5 21 2.5 17 2.5" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M10 15.9094V19.1994C10 21.1994 9.2 21.9994 7.2 21.9994H4.8C2.8 21.9994 2 21.1994 2 19.1994V15.9094C2 13.9094 2.8 13.1094 4.8 13.1094H7.2C9.2 13.1094 10 13.9094 10 15.9094Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M22 15.9094V19.1994C22 21.1994 21.2 21.9994 19.2 21.9994H16.8C14.8 21.9994 14 21.1994 14 19.1994V15.9094C14 13.9094 14.8 13.1094 16.8 13.1094H19.2C21.2 13.1094 22 13.9094 22 15.9094Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

Explore</a></li>
                        <li><a href="./insights">

<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5.89999 17H18.09C19.99 17 20.99 16 20.99 14.1V2H2.98999V14.1C2.99999 16 3.99999 17 5.89999 17Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2 2H22" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M8 22L12 20V17" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M16 22L12 20" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M7.5 11L10.65 8.37C10.9 8.16 11.23 8.22 11.4 8.5L12.6 10.5C12.77 10.78 13.1 10.83 13.35 10.63L16.5 8" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
Insights</a></li>
                    </ul>
                    <hr>
                    <ul>
                        <li><a href="./config">
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2 12.88V11.12C2 10.08 2.85 9.22 3.9 9.22C5.71 9.22 6.45 7.94 5.54 6.37C5.02 5.47 5.33 4.3 6.24 3.78L7.97 2.79C8.76 2.32 9.78 2.6 10.25 3.39L10.36 3.58C11.26 5.15 12.74 5.15 13.65 3.58L13.76 3.39C14.23 2.6 15.25 2.32 16.04 2.79L17.77 3.78C18.68 4.3 18.99 5.47 18.47 6.37C17.56 7.94 18.3 9.22 20.11 9.22C21.15 9.22 22.01 10.07 22.01 11.12V12.88C22.01 13.92 21.16 14.78 20.11 14.78C18.3 14.78 17.56 16.06 18.47 17.63C18.99 18.54 18.68 19.7 17.77 20.22L16.04 21.21C15.25 21.68 14.23 21.4 13.76 20.61L13.65 20.42C12.75 18.85 11.27 18.85 10.36 20.42L10.25 20.61C9.78 21.4 8.76 21.68 7.97 21.21L6.24 20.22C5.33 19.7 5.02 18.53 5.54 17.63C6.45 16.06 5.71 14.78 3.9 14.78C2.85 14.78 2 13.92 2 12.88Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
Config</a></li>
                    </ul>
                    <p class="copyrights">© 2025 Iceberg. All rights reserved.</p>
                </div>
                <div class="col-md-10">
                      
                   <div class="wrapper">
    
<div class="col12">
<div class="col8">
<div class="cta-inner">
    <div class="head"><small>Dataset name</small></div>

<h2 id="dataset_name"></h2>
<p>Upload your raw data and let AI automatically clean missing values, fix formatting issues, standardize columns, and generate insights — instantly and accurately</p>
<button id="open-upload-modal" class="btn-primary"  type="button" >
 Fix</button>
    <div class="foot"><h6>Preview</h6></div>

</div>
</div>
<div class="col4">
        <div class="card-dark">
        <div class="head"><span class="title">Total Quality Score</span></div>
            <div class="chart">
                <div class="qualityScoreChart"> 
                <canvas id="qualityScoreChart" height="50"></canvas>

                </div>
            </div>
            <div class="middle">
            <div class="col12">
                <div class="col4"><div class=" "><strong id="row_count"></strong></div><div class=" "><span>Total Rows</span></div></div>
                <div class="col4"><div class=" "><strong id="most_frequent_type">Int64</strong></div><div class=" "><span>Most frequent type</span></div></div>
                <div class="col4"><div class=" "><strong id="column_count"></strong></div><div class=" "><span>Tatal Columns</span></div></div>
            </div>
            </div>
    <div class="foot"></div>
    </div>

</div>
</div>
<div class="col12">
<div class="col8">
    <div class="card-preview">
    <!-- <div class="head"><div class="title">Preview</div><div class="legend">555 Cols</div></div> -->
    <div class="preview"><table id="dataTable" cell></table></div>
    <!-- <div class="foot"><div class="note">Normalization</div><div class="action"><a href="#" class="tag high">High</a></div></div> -->
    </div>
</div>
<div class="col4">
    <div class="col12">
<div class="col6">
    <div class="card">
<div class="head"><div class="title">Duplicate rows</div><div class="legend"><span id="duplicates-val"></span> Rows</div></div>
            <div class="chart"><div class="duplicateChart"><canvas id="duplicateChart" height="50"></canvas></div></div>
            <div class="foot"><div class="note">Normalization</div><div class="action"><a href="#" class="tag high">High</a></div></div>
        </div>
</div>
<div class="col6">
    <div class="card">
<div class="head"><div class="title">Missing values</div><div class="legend"><span id="missing-val"></span> Fields</div></div>
    <div class="chart "><div class="missingChart"><canvas id="missingChart" height="50"></canvas></div></div>
            <div class="foot"><div class="note">Normalization</div><div class="action"><a href="#" class="tag high">High</a></div></div>
        </div>
</div>
    </div>

    
    <div class="col12">
<div class="col6">
    <div class="card">
<div class="head"><div class="title">Distribution</div><div class="legend"><span id="outlier-val"></span> Outlier</div></div>
    <div class="chart">
    <canvas id="skewnessChart" ></canvas>
    </div>
    <div class="foot"><div class="note">Normalization</div><div class="action"><a href="#" class="tag high">High</a></div></div>
        </div>
</div>
<div class="col6">
    <div class="card">
<div class="head"><div class="title">Correlation</div><div class="legend"><span id="pair-val"></span> Pair</div></div>
    <div class="chart">
    <canvas id="correlationHeatmap"  ></canvas>

    </div>
            <div class="foot"><div class="note">Normalization</div><div class="action"><a href="#" class="tag high">High</a></div></div>
        </div>
</div>
    </div>


    <div class="col12">
<div class="col4">
    <div class="card">
<div class="head"><div class="title">Normalization</div></div>
            <div class="chart"><span id="normalization-val"></span></div>
            <div class="foot"><div class="note">Normalization</div><div class="action"><a href="#" class="tag high">High</a></div></div>
        </div>
</div>
<div class="col4">
    <div class="card">
<div class="head"><div class="title">PII</div></div>
            <div class="chart"><span id="pii-val"></span></div>
       
            <div class="foot"><div class="note">Normalization</div><div class="action"><a href="#" class="tag high">High</a></div></div>
        </div>
</div>
    <div class="col4">
        <div class="card">
            <div class="head"><div class="title">Invalid</div></div>
            <div class="chart"><span id="invalid-val"></span></div>
            <div class="foot"><div class="note">Normalization</div><div class="action"><a href="#" class="tag high">High</a></div></div>
        </div>
    </div>
    </div>
</div>
</div>
                   </div>

                </div>
            </div>
            
        </main>
     
    </div>



 

<script src="static/js/jquery-3.6.0.min.js"></script>
<!-- Logic Script -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    // 1. Retrieve Data
    const rawData = sessionStorage.getItem('dqResult');
    
    // if (!rawData) {
    //     alert("No data found. Redirecting to upload.");
    //     window.location.href = "/";
    //     return;
    // }

    const data = JSON.parse(rawData);

    $("#most_frequent_type").html(data.quality_score);
    $("#most_frequent_type").html(data.most_frequent_dtype);
    $("#missing-val").html(data.missing_count);
    $("#duplicates-val").html(data.duplicate_count);
    $("#row_count").html(data.row_count);
    $("#column_count").html(data.column_count); 
    $("#dataset_name").html(data.dataset_name);
    $("#outlier-val").html(data.outliers.length > 0 ? data.outliers.length : 0);
    $("#pair-val").html(data.correlation.length > 0 ? data.correlation.length : 0);
    $("#normalization-val").html(data.normalization_issues.length > 0 ? data.normalization_issues.length : 0);
 
    $("#pii-val").html(data.pii_fields.length > 0 ? data.pii_fields.length : 0);
    $("#invalid-val").html(Object.values(data.invalid_fields).reduce((a, b) => a + b, 0));
        
    console.log(data);  

 

    const canvas = document.getElementById('qualityScoreChart');
    const ctx = canvas.getContext('2d');

    // 1. Create the gradient (x0, y0, x1, y1)
    // This creates a gradient from Left to Right
    const gradient = ctx.createLinearGradient(0, 0, 400, 0);
    
    // 2. Define color stops (0 = start, 1 = end)
    gradient.addColorStop(0, '#f371c8');  // Red (Start)
    gradient.addColorStop(.25, '#dfeb8c');  
    gradient.addColorStop(.50, '#75d8b8');  // Pink (End)
    // 2. Define the "Center Text" Plugin
    const gaugeTextPlugin = {
        id: 'gaugeText',
        beforeDraw(chart) {
            const { ctx, chartArea: { top, bottom, left, right, width, height } } = chart;
            
            ctx.save();
            // Styling
            ctx.font = 'bold 30px sans-serif';
            ctx.fillStyle = '#fff';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';

            // Get value dynamically from the dataset
            const value =  (Math.round(chart.data.datasets[0].data[0] * 100) / 100  ) + '%';
            
            // Position: Center X, and slightly up from the bottom for a gauge feel
            const x = width / 2;
            const y =  height / 2 + 40; // Adjust '40' to move up/down
            
            ctx.fillText(value, x, y);
            ctx.restore();
        }
    };
    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Score', 'Empty'],
            datasets: [{
                data: [data.quality_score, 100 - data.quality_score],
                // 3. Assign the gradient variable here
                backgroundColor: [gradient, '#333333'], 
                borderWidth: 0,
                
                // Add this property
                borderRadius: 4
            }]
        },
        options: {
            responsive: true,
            rotation: -90,
            circumference: 180,
            cutout: '70%',
            plugins: { legend: { display: false }, tooltip: { enabled: false } }
        },
        // 3. Register the plugin here
        plugins: [gaugeTextPlugin]
    });



    /*Missing values*/
    if( data.missing_count!=0){
        

    const missingChartcanvas = document.getElementById('missingChart');
    const missingChartctx = missingChartcanvas.getContext('2d');
    // 1. Create the gradient (x0, y0, x1, y1)
    // This creates a gradient from Left to Right
    const missingChartgradient = missingChartctx.createLinearGradient(0, 0, 400, 0);
    
    // 2. Define color stops (0 = start, 1 = end)
    missingChartgradient.addColorStop(0, '#75d8b8');  // Red (Start)
    missingChartgradient.addColorStop(.25, '#dfeb8c');  
    missingChartgradient.addColorStop(.50, '#f371c8');  // Pink (End)
     
    new Chart(missingChartctx, {
        type: 'doughnut',
        data: {
            labels: ['Score', 'Empty'],
            datasets: [{
                data: [data.missing_score, 100 - data.missing_score],
                // 3. Assign the gradient variable here
                backgroundColor: [missingChartgradient, '#333333'], 
                borderWidth: 0,
                
                // Add this property
                borderRadius: 4
            }]
        },
        options: {
            responsive: true,
            rotation: -90,
            circumference: 180,
            cutout: '70%',
            plugins: { legend: { display: false }, tooltip: { enabled: false } }
        },
          // 3. Register the plugin here
        plugins: [gaugeTextPlugin]
 
    });
 
 
    }
    else{
        $(".missingChart").html("<h3>No Missing Values</h3>");
    }

    /*duplicate values*/
    if( data.duplicate_count!=0){
        
    const duplicateChartcanvas = document.getElementById('duplicateChart');
    const duplicateChartctx = duplicateChartcanvas.getContext('2d');
    // 1. Create the gradient (x0, y0, x1, y1)
    // This creates a gradient from Left to Right
    const duplicateChartgradient = duplicateChartctx.createLinearGradient(0, 0, 400, 0);
    
    // 2. Define color stops (0 = start, 1 = end)
    duplicateChartgradient.addColorStop(0, '#f371c8');  // Red (Start)
    duplicateChartgradient.addColorStop(.25, '#dfeb8c');  
    duplicateChartgradient.addColorStop(.50, '#75d8b8');  // Pink (End)
 
    new Chart(duplicateChartctx, {
        type: 'doughnut',
        data: {
            labels: ['Score', 'Empty'],
            datasets: [{
                data: [(data.duplicate_count/data.row_count)*100, 100 - (data.duplicate_count/data.row_count)*100],
                // 3. Assign the gradient variable here
                backgroundColor: [duplicateChartgradient, '#333333'], 
                borderWidth: 0,
                
                // Add this property
                borderRadius: 4
            }]
        },
        options: {
            responsive: true,
            rotation: -90,
            circumference: 180,
            cutout: '70%',
            plugins: { legend: { display: false }, tooltip: { enabled: false } }
        },
        // 3. Register the plugin here
        plugins: [gaugeTextPlugin]
 
    });
 
    }
    else{
        $(".duplicateChart").html("<h3>No Duplicate Values</h3>");
    }


    const $table = $('#dataTable');

            // 1. Get the column headers from the first object
            if (data.preview.length > 0) {
                const headers = Object.keys(data.preview[0]);
                // 2. Create the Table Header (<thead>)
                let headerRow = '<thead><tr><tr><th>N</th>';
                headers.forEach(function(header) {
                    // Normalize header text for better readability
                    let displayHeader = header.replace(/([A-Z])/g, ' $1').trim();
                    headerRow += `<th>${displayHeader}</th>`;
                });
                headerRow += '</tr></thead>';
                $table.append(headerRow);

                // 3. Create the Table Body (<tbody>) and populate rows
                let tableBody = '<tbody>';
                data.preview.forEach(function(rowData, index) {
                    let row = `<tr><td>${index + 1}</td>`;
                    // Iterate over values in the correct column order
                    headers.forEach(function(key) {
                        let value = rowData[key];
                        // Format numbers for better display (optional)
                        if (typeof value === 'number' && key !== 'Volume') {
                            value = value.toFixed(4); // Display prices with 4 decimal places
                        }
                        // Format Volume for better display (optional)
                        if (key === 'Volume') {
                            // Using toLocaleString for comma separation on large numbers
                            value = value.toLocaleString();
                        }
                        row += `<td>${value}</td>`;
                    });
                    row += '</tr>';
                    tableBody += row;
                });
                tableBody += '</tbody>';
                $table.append(tableBody);
            }
});




</script>
 

 

</body>
</html>